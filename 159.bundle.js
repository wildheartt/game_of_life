(()=>{"use strict";const e=new class{#e=0;#t=!1;get activeCells(){return this.#e}#s=new Map;get field(){return this.#s}#i=new Map;get buffer(){return this.#i}#l=10;#r=10;get rows(){return this.#l}get cols(){return this.#r}constructor(){}#h(e){this.#s=new Map,this.#i=new Map,this.#e=0;for(let t=0;t<this.#l;t++)for(let s=0;s<this.#r;s++){const i=this.#o(t,s),l=1===Math.round(Math.random()),r=!0===e&&l;!0===r&&this.#e++,this.#s.set(i,r)}}initFields(e,t,s){return this.#l=t,this.#r=s,this.#t=e,this.#h(e),{cols:this.cols,rows:this.rows,activeCells:this.activeCells,field:this.field,buffer:this.buffer}}#o(e,t){return`${e}-${t}`}#f(e,t){let s=0;for(let i=-1;i<=1;i++)for(let l=-1;l<=1;l++){if(0===i&&0===l)continue;const r=(e+i+this.#l)%this.#l,h=(t+l+this.#r)%this.#r,o=this.#o(r,h);this.#s.get(o)&&s++}return s}#a(){this.#e=0,this.#i=new Map;for(let e=0;e<this.#l;e++)for(let t=0;t<this.#r;t++){const s=this.#f(e,t),i=this.#o(e,t);this.#s.get(i)?s<2||s>3?this.#i.set(i,!1):(this.#e++,this.#i.set(i,!0)):3===s?(this.#e++,this.#i.set(i,!0)):this.#i.set(i,!1)}[this.#s,this.#i]=[this.#i,this.#s]}updateField(){return this.#a(),{cols:this.cols,rows:this.rows,activeCells:this.activeCells,field:this.field,buffer:this.buffer}}deleteOrCreateCell(e,t){"delete"===e?(this.#e--,this.#s.set(t,!1)):"create"===e&&(this.#e++,this.#s.set(t,!0))}#d(e,t,s){if(e===this.#l&&t===this.#r)return;const i=this.#s,l=this.#l,r=this.#r;this.#t=s,this.#l=e,this.#r=t,this.#s=new Map,this.#i=new Map,this.#e=0;for(let s=0;s<e;s++)for(let e=0;e<t;e++){const t=this.#o(s,e),l=i.get(t)||!1;!0===l&&this.#e++,this.#s.set(t,l)}if(e>l||t>r)for(let s=0;s<e;s++)for(let e=0;e<t;e++){const t=this.#o(s,e);if(!i.has(t)){const e=1===Math.round(Math.random()),s=!0===this.#t&&e;!0===s&&this.#e++,this.#s.set(t,s)}}if(e<l||t<r){for(let s=0;s<e;s++)for(let e=0;e<t;e++){const t=this.#o(s,e),l=!!i.get(t);!0===l&&this.#e++,this.#i.set(t,l)}this.#s=this.#i,this.#i=i}}resizeField(e,t,s){return this.#d(e,t,s),{cols:this.cols,rows:this.rows,activeCells:this.activeCells,field:this.field,buffer:this.buffer}}};onmessage=function(t){const s=t.data,i=s.type,l=s.payload;if("initFields"===i){const t=e.initFields(l.random,l.rows,l.cols);postMessage({type:"result: initFields",data:t})}else if("updateField"===i){const t=e.updateField();postMessage({type:"result: updateField",data:t})}else if("deleteOrCreateCell"===i){const t=e.deleteOrCreateCell(l.typeAction,l.key);postMessage({type:"result: deleteOrCreateCell",data:t})}else if("resizeField"===i){const t=e.resizeField(l.newRows,l.newCols,l.random);postMessage({type:"result: resizeField",data:t})}}})();